<?xml version="1.0"?>
<project default="devbuild">

	<!-- Simply set the name of the plugin here, e.g. "fileUpload" or "file_upload") instead of "sample" -->
	<property name="name" value="sample" />

	<!-- Use this task to let ant copy the compiled jar files to the target folders for development  -->
	<target name="devbuild">
		<exec executable="mvn">
			<arg value="package"/>
		</exec>
		<copy file="target/plugin_intranda_opac_${name}.jar" todir="/opt/digiverso/goobi/plugins/opac/" overwrite="true"/>
	</target>

	<!-- Use this task to let configuration, plugin, user interface files and maven artifact be renamed to your plugin name -->
	<target name="rename">
		<replace file="pom.xml" token="&lt;artifactId&gt;sample" value="&lt;artifactId&gt;${name}" />

		<replace file="pom.xml" token="goobi-plugin-opac-sample" value="goobi-plugin-opac-${name}" />
		<replace file="pom.xml" token="&lt;artifactId&gt;sample" value="&lt;artifactId&gt;${name}" />
		<replace file="pom.xml" token="&lt;jar.name&gt;plugin_intranda_opac_sample" value="&lt;jar.name&gt;plugin_intranda_opac_${name}" />

		<move file="plugin_intranda_opac_sample.xml" tofile="plugin_intranda_opac_${name}.xml" failonerror="false"/>

		<script language="javascript">
				var words = project.getProperty("name").split("_");
			var name = "";
			for (i = 0; i &lt; words.length; i++) {
				name += words[i].replace( /^.|\s\S/g, function(a) { return a.toUpperCase(); });
						}
			project.setProperty("capitalize", name);
		</script>

		<move file="src/main/java/de/intranda/goobi/plugins/SampleOpacPlugin.java" tofile="src/main/java/de/intranda/goobi/plugins/${capitalize}OpacPlugin.java" failonerror="false"/>
		<replace file="src/main/java/de/intranda/goobi/plugins/${capitalize}OpacPlugin.java" token="SampleOpacPlugin" value="${capitalize}OpacPlugin" />
		<replace file="src/main/java/de/intranda/goobi/plugins/${capitalize}OpacPlugin.java" token="intranda_opac_sample" value="intranda_opac_${name}" />
		<replace file="src/main/java/de/intranda/goobi/plugins/${capitalize}OpacPlugin.java" token="plugin_opac_sample" value="plugin_opac_${name}" />
		<replace file="src/main/java/de/intranda/goobi/plugins/${capitalize}OpacPlugin.java" token="Sample opac plugin" value="${capitalize} opac plugin" />

		<move file="src/test/java/de/intranda/goobi/plugins/SampleOpacPluginTest.java" tofile="src/test/java/de/intranda/goobi/plugins/${capitalize}OpacPluginTest.java" failonerror="false"/>
		<replace file="src/test/java/de/intranda/goobi/plugins/${capitalize}OpacPluginTest.java" token="SampleOpacPlugin" value="${capitalize}OpacPlugin" />
		<replace file="src/test/java/de/intranda/goobi/plugins/${capitalize}OpacPluginTest.java" token="plugin_intranda_opac_sample" value="plugin_intranda_opac_${name}" />

		<replace file="../README.md" token="plugin-opac-sample" value="plugin-opac-${name}" />
		<replace file="../README.md" token="intranda_opac_sample" value="intranda_opac_${name}" />
		<replaceregexp file="../README.md" match="This is the(.*?)interface." flags="gs"
			replace="This is the ${capitalize} Goobi opac plugin. A description for this plugin is still missing." />
		<replaceregexp file="../README.md" match="## KICKSTART(.*?)## Plugin details" flags="gs" replace="## Plugin details" />

		<replace file=".project" token="A-goobi-plugin-opac-sample" value="goobi-plugin-opac-${name}" />
		<replaceregexp file="build.xml" match="\t&lt;!-- Use this task to let configuration(.*?)&lt;/project&gt;" flags="gs" replace="&lt;/project&gt;" />

	</target>
</project>
